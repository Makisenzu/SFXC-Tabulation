import{r as i,a as d,j as e}from"./app-BFXxh3rB.js";import{e as v,b as p,c as N,d as w}from"./index-C1YQJVUj.js";import _ from"./ViewMedalTallyModal-Du_2COyB.js";import"./iconBase-Nzms_O-n.js";function S(){const[n,g]=i.useState([]),[t,h]=i.useState({current_page:1,last_page:1,per_page:10,total:0}),[u,c]=i.useState(!0),[y,x]=i.useState(!1),[o,m]=i.useState(null);i.useEffect(()=>{l()},[]);const l=async(a=1)=>{try{const s=await d.get("/getArchivedMedalTallies",{params:{page:a,per_page:t.per_page}});g(s.data.data),h({current_page:s.data.current_page,last_page:s.data.last_page,per_page:s.data.per_page,total:s.data.total}),c(!1)}catch(s){console.error("Error fetching archived medal tallies:",s),c(!1)}},b=async a=>{if(confirm("Are you sure you want to unarchive this medal tally?"))try{await d.post(`/unarchiveMedalTally/${a}`),l()}catch(s){console.error("Error unarchiving medal tally:",s)}},f=async a=>{try{const s=await d.get(`/getMedalTally/${a.id}`);m(s.data),x(!0)}catch(s){console.error("Error fetching tally details:",s)}},j=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return u?e.jsx("div",{className:"text-center py-8",children:"Loading archived medal tallies..."}):e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Archived Medal Tallies"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"View past medal tallies and their complete results"})]}),e.jsxs("a",{href:"/admin/medal-tally",className:"flex items-center gap-2 px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm sm:text-base w-full sm:w-auto justify-center",children:[e.jsx(v,{})," Back to Active"]})]})}),n.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(p,{className:"mx-auto text-gray-300 mb-4",size:64}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No archived medal tallies yet"}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Medal tallies that are archived will appear here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tally Title"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell",children:"Competitions"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Participants"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Archived Date"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm font-medium text-gray-900",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:a.tally_title}),e.jsx("div",{className:"md:hidden mt-1",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.events?.slice(0,2).map((s,r)=>e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:s.event_name},r)),a.events?.length>2&&e.jsxs("span",{className:"inline-block px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:["+",a.events.length-2," more"]})]})})]})]})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900 hidden md:table-cell",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:a.events?.map((s,r)=>e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:s.event_name},r))})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900",children:e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-green-100 text-green-800 rounded font-medium",children:a.participants?.length||0})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-500",children:j(a.archived_at)}),e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(a),className:"text-green-600 hover:text-green-900 p-2",title:"View Tally",children:e.jsx(N,{size:16})}),e.jsx("button",{onClick:()=>b(a.id),className:"text-blue-600 hover:text-blue-900 p-2",title:"Unarchive",children:e.jsx(w,{size:16})})]})})]},a.id))})]})}),t.last_page>1&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",n.length>0?(t.current_page-1)*t.per_page+1:0," to ",Math.min(t.current_page*t.per_page,t.total)," of ",t.total," entries"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>l(t.current_page-1),disabled:t.current_page===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("div",{className:"hidden sm:flex gap-1",children:[...Array(t.last_page)].map((a,s)=>{const r=s+1;return r===1||r===t.last_page||r>=t.current_page-1&&r<=t.current_page+1?e.jsx("button",{onClick:()=>l(r),className:`px-3 py-2 text-sm font-medium rounded-lg ${r===t.current_page?"bg-blue-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:r},r):r===t.current_page-2||r===t.current_page+2?e.jsx("span",{className:"px-2 py-2",children:"..."},r):null})}),e.jsx("button",{onClick:()=>l(t.current_page+1),disabled:t.current_page===t.last_page,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}),y&&o&&e.jsx(_,{tally:o,onClose:()=>{x(!1),m(null)},onUpdate:()=>{l()},isArchived:!0})]})}export{S as default};
