import{r as c,a as p,j as e}from"./app-CJQL5-s2.js";import{q as j,m as v,g as N}from"./index-BTPW2H51.js";import"./iconBase-DIbz7Cz-.js";function P({onClose:o,onSuccess:m}){const[d,i]=c.useState([]),[r,n]=c.useState({tally_title:"",event_ids:[],participants:[""]});c.useEffect(()=>{x()},[]);const x=async()=>{try{const t=(await p.get("/getEvents?per_page=100&show_past=false")).data;t.data&&Array.isArray(t.data)?i(t.data):Array.isArray(t)?i(t):i([])}catch(a){console.error("Error fetching events:",a),i([])}},g=a=>{const{name:t,value:s}=a.target;n(l=>({...l,[t]:s}))},u=a=>{n(t=>({...t,event_ids:t.event_ids.includes(a)?t.event_ids.filter(s=>s!==a):[...t.event_ids,a]}))},h=(a,t)=>{n(s=>{const l=[...s.participants];return l[a]=t,{...s,participants:l}})},y=()=>{n(a=>({...a,participants:[...a.participants,""]}))},b=a=>{r.participants.length>1&&n(t=>({...t,participants:t.participants.filter((s,l)=>l!==a)}))},f=async a=>{a.preventDefault();const t=r.participants.filter(s=>s.trim()!=="");if(t.length===0){alert("Please add at least one participant");return}if(r.event_ids.length===0){alert("Please select at least one competition");return}try{await p.post("/createMedalTally",{...r,participants:t}),m()}catch(s){console.error("Error creating medal tally:",s),alert("Failed to create medal tally")}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl my-8 mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Create Medal Tally"}),e.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700",children:e.jsx(j,{size:20})})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto pr-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tally Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"tally_title",value:r.tally_title,onChange:g,required:!0,placeholder:"e.g., SFXC 2024 Medal Tally",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Competitions ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto",children:d.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No events available"}):d.map(a=>e.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.event_ids.includes(a.id),onChange:()=>u(a.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm",children:a.event_name})]},a.id))}),r.event_ids.length>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[r.event_ids.length," competition(s) selected"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Participants ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[r.participants.map((a,t)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:a,onChange:s=>h(t,s.target.value),placeholder:`Participant ${t+1}`,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),r.participants.length>1&&e.jsx("button",{type:"button",onClick:()=>b(t),className:"px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",children:e.jsx(v,{size:14})})]},t)),e.jsxs("button",{type:"button",onClick:y,className:"flex items-center gap-2 px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:[e.jsx(N,{size:12})," Add Participant"]})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Create Medal Tally"}),e.jsx("button",{type:"button",onClick:o,className:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium",children:"Cancel"})]})]})]})})}export{P as default};
