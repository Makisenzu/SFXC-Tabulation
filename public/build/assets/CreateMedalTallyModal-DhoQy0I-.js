import{r as i,a as d,j as e}from"./app-CH0gpIS3.js";import{p as j,l as v,f as N}from"./index-CdVbtZtg.js";import"./iconBase-B_5RcGw1.js";function P({onClose:c,onSuccess:p}){const[o,m]=i.useState([]),[l,n]=i.useState({tally_title:"",event_ids:[],participants:[""]});i.useEffect(()=>{x()},[]);const x=async()=>{try{const t=await d.get("/getEvents");m(t.data)}catch(t){console.error("Error fetching events:",t)}},u=t=>{const{name:a,value:s}=t.target;n(r=>({...r,[a]:s}))},g=t=>{n(a=>({...a,event_ids:a.event_ids.includes(t)?a.event_ids.filter(s=>s!==t):[...a.event_ids,t]}))},h=(t,a)=>{n(s=>{const r=[...s.participants];return r[t]=a,{...s,participants:r}})},y=()=>{n(t=>({...t,participants:[...t.participants,""]}))},b=t=>{l.participants.length>1&&n(a=>({...a,participants:a.participants.filter((s,r)=>r!==t)}))},f=async t=>{t.preventDefault();const a=l.participants.filter(s=>s.trim()!=="");if(a.length===0){alert("Please add at least one participant");return}if(l.event_ids.length===0){alert("Please select at least one competition");return}try{await d.post("/createMedalTally",{...l,participants:a}),p()}catch(s){console.error("Error creating medal tally:",s),alert("Failed to create medal tally")}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl my-8 mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Create Medal Tally"}),e.jsx("button",{onClick:c,className:"text-gray-500 hover:text-gray-700",children:e.jsx(j,{size:20})})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto pr-2",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tally Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"tally_title",value:l.tally_title,onChange:u,required:!0,placeholder:"e.g., SFXC 2024 Medal Tally",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Competitions ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"border border-gray-300 rounded-lg p-3 max-h-48 overflow-y-auto",children:o.length===0?e.jsx("p",{className:"text-gray-500 text-sm",children:"No events available"}):o.map(t=>e.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l.event_ids.includes(t.id),onChange:()=>g(t.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm",children:t.event_name})]},t.id))}),l.event_ids.length>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[l.event_ids.length," competition(s) selected"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Participants ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[l.participants.map((t,a)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:t,onChange:s=>h(a,s.target.value),placeholder:`Participant ${a+1}`,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),l.participants.length>1&&e.jsx("button",{type:"button",onClick:()=>b(a),className:"px-3 py-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200",children:e.jsx(v,{size:14})})]},a)),e.jsxs("button",{type:"button",onClick:y,className:"flex items-center gap-2 px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:[e.jsx(N,{size:12})," Add Participant"]})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Create Medal Tally"}),e.jsx("button",{type:"button",onClick:c,className:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 font-medium",children:"Cancel"})]})]})]})})}export{P as default};
