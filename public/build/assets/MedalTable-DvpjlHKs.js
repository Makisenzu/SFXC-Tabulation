import{r as i,a as n,j as e}from"./app-CPzmvJ56.js";import{b as g,g as w,c as _,m as M}from"./index-DBw3qoLo.js";import T from"./CreateMedalTallyModal-ipjkqx0K.js";import k from"./ViewMedalTallyModal-CVZLIsHl.js";import"./iconBase-rNp-wLtq.js";function F(){const[d,h]=i.useState([]),[a,u]=i.useState({current_page:1,last_page:1,per_page:10,total:0}),[y,o]=i.useState(!0),[b,c]=i.useState(!1),[f,x]=i.useState(!1),[p,m]=i.useState(null);i.useEffect(()=>{l()},[]);const l=async(s=1)=>{try{const t=await n.get("/getMedalTallies",{params:{page:s,per_page:a.per_page}});h(t.data.data),u({current_page:t.data.current_page,last_page:t.data.last_page,per_page:t.data.per_page,total:t.data.total}),o(!1)}catch(t){console.error("Error fetching medal tallies:",t),o(!1)}},j=async s=>{if(confirm("Are you sure you want to delete this medal tally?"))try{await n.delete(`/deleteMedalTally/${s}`),l()}catch(t){console.error("Error deleting medal tally:",t)}},v=async s=>{if(confirm("Are you sure you want to archive this medal tally?"))try{await n.post(`/archiveMedalTally/${s}`),l()}catch(t){console.error("Error archiving medal tally:",t)}},N=async s=>{try{const t=await n.get(`/getMedalTally/${s.id}`);m(t.data),x(!0)}catch(t){console.error("Error fetching tally details:",t)}};return y?e.jsx("div",{className:"text-center py-8",children:"Loading medal tallies..."}):e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Medal Tally Management"}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs("a",{href:"/admin/archived-medal-tallies",className:"flex items-center gap-2 px-3 sm:px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm sm:text-base justify-center",children:[e.jsx(g,{})," View Archived"]}),e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm sm:text-base justify-center",children:[e.jsx(w,{})," Create Medal Tally"]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tally Title"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell",children:"Competitions"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Participants"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-3 sm:px-6 py-4 text-center text-gray-500 text-sm",children:"No medal tallies found"})}):d.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-3 sm:px-6 py-4 text-sm font-medium text-gray-900",children:[e.jsx("div",{className:"font-semibold",children:s.tally_title}),e.jsx("div",{className:"md:hidden mt-1",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.events?.slice(0,2).map((t,r)=>e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:t.event_name},r)),s.events?.length>2&&e.jsxs("span",{className:"inline-block px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:["+",s.events.length-2," more"]})]})})]}),e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900 hidden md:table-cell",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.events?.map((t,r)=>e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:t.event_name},r))})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900",children:e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-green-100 text-green-800 rounded font-medium",children:s.participants?.length||0})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N(s),className:"text-green-600 hover:text-green-900 p-2",title:"View & Edit Scores",children:e.jsx(_,{size:16})}),e.jsx("button",{onClick:()=>v(s.id),className:"text-blue-600 hover:text-blue-900 p-2",title:"Archive",children:e.jsx(g,{size:16})}),e.jsx("button",{onClick:()=>j(s.id),className:"text-red-600 hover:text-red-900 p-2",title:"Delete",children:e.jsx(M,{size:16})})]})})]},s.id))})]})}),a.last_page>1&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",d.length>0?(a.current_page-1)*a.per_page+1:0," to ",Math.min(a.current_page*a.per_page,a.total)," of ",a.total," entries"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>l(a.current_page-1),disabled:a.current_page===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("div",{className:"hidden sm:flex gap-1",children:[...Array(a.last_page)].map((s,t)=>{const r=t+1;return r===1||r===a.last_page||r>=a.current_page-1&&r<=a.current_page+1?e.jsx("button",{onClick:()=>l(r),className:`px-3 py-2 text-sm font-medium rounded-lg ${r===a.current_page?"bg-blue-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:r},r):r===a.current_page-2||r===a.current_page+2?e.jsx("span",{className:"px-2 py-2",children:"..."},r):null})}),e.jsx("button",{onClick:()=>l(a.current_page+1),disabled:a.current_page===a.last_page,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}),b&&e.jsx(T,{onClose:()=>c(!1),onSuccess:()=>{l(),c(!1)}}),f&&p&&e.jsx(k,{tally:p,onClose:()=>{x(!1),m(null)},onUpdate:()=>{l()}})]})}export{F as default};
