import{r as n,a as c,j as e}from"./app--_hvIVQq.js";import{f as N,c as w,l as v}from"./index-BMjdZWFM.js";import _ from"./CreateMedalTallyModal-BAAi6kjr.js";import M from"./ViewMedalTallyModal-CwY8b71K.js";import"./iconBase-CRP-8bNW.js";function V(){const[d,g]=n.useState([]),[t,h]=n.useState({current_page:1,last_page:1,per_page:10,total:0}),[u,o]=n.useState(!0),[y,i]=n.useState(!1),[b,x]=n.useState(!1),[p,m]=n.useState(null);n.useEffect(()=>{r()},[]);const r=async(s=1)=>{try{const a=await c.get("/getMedalTallies",{params:{page:s,per_page:t.per_page}});g(a.data.data),h({current_page:a.data.current_page,last_page:a.data.last_page,per_page:a.data.per_page,total:a.data.total}),o(!1)}catch(a){console.error("Error fetching medal tallies:",a),o(!1)}},f=async s=>{if(confirm("Are you sure you want to delete this medal tally?"))try{await c.delete(`/deleteMedalTally/${s}`),r()}catch(a){console.error("Error deleting medal tally:",a)}},j=async s=>{try{const a=await c.get(`/getMedalTally/${s.id}`);m(a.data),x(!0)}catch(a){console.error("Error fetching tally details:",a)}};return u?e.jsx("div",{className:"text-center py-8",children:"Loading medal tallies..."}):e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Medal Tally Management"}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm sm:text-base w-full sm:w-auto justify-center",children:[e.jsx(N,{})," Create Medal Tally"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tally Title"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider hidden md:table-cell",children:"Competitions"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Participants"}),e.jsx("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-3 sm:px-6 py-4 text-center text-gray-500 text-sm",children:"No medal tallies found"})}):d.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-3 sm:px-6 py-4 text-sm font-medium text-gray-900",children:[e.jsx("div",{className:"font-semibold",children:s.tally_title}),e.jsx("div",{className:"md:hidden mt-1",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.events?.slice(0,2).map((a,l)=>e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:a.event_name},l)),s.events?.length>2&&e.jsxs("span",{className:"inline-block px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:["+",s.events.length-2," more"]})]})})]}),e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900 hidden md:table-cell",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:s.events?.map((a,l)=>e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:a.event_name},l))})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm text-gray-900",children:e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-green-100 text-green-800 rounded font-medium",children:s.participants?.length||0})}),e.jsx("td",{className:"px-3 sm:px-6 py-4 text-sm",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>j(s),className:"text-green-600 hover:text-green-900 p-2",title:"View & Edit Scores",children:e.jsx(w,{size:16})}),e.jsx("button",{onClick:()=>f(s.id),className:"text-red-600 hover:text-red-900 p-2",title:"Delete",children:e.jsx(v,{size:16})})]})})]},s.id))})]})}),t.last_page>1&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",d.length>0?(t.current_page-1)*t.per_page+1:0," to ",Math.min(t.current_page*t.per_page,t.total)," of ",t.total," entries"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>r(t.current_page-1),disabled:t.current_page===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("div",{className:"hidden sm:flex gap-1",children:[...Array(t.last_page)].map((s,a)=>{const l=a+1;return l===1||l===t.last_page||l>=t.current_page-1&&l<=t.current_page+1?e.jsx("button",{onClick:()=>r(l),className:`px-3 py-2 text-sm font-medium rounded-lg ${l===t.current_page?"bg-blue-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:l},l):l===t.current_page-2||l===t.current_page+2?e.jsx("span",{className:"px-2 py-2",children:"..."},l):null})}),e.jsx("button",{onClick:()=>r(t.current_page+1),disabled:t.current_page===t.last_page,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})}),y&&e.jsx(_,{onClose:()=>i(!1),onSuccess:()=>{r(),i(!1)}}),b&&p&&e.jsx(M,{tally:p,onClose:()=>{x(!1),m(null)},onUpdate:()=>{r()}})]})}export{V as default};
