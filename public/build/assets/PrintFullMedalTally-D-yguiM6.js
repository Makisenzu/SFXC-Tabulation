import{r as d,j as e,H as h}from"./app-DtBfZdBf.js";import{a as g}from"./printLogo-Dw7oCvxT.js";function f({tally:a}){const[c,x]=d.useState(null);d.useEffect(()=>{fetch("/api/settings/logo").then(t=>t.json()).then(t=>{t.logo&&x(`/storage/${t.logo}`)}).catch(t=>console.error("Error loading event logo:",t))},[]),d.useEffect(()=>{window.print()},[]);const o=t=>{const l=a.scores.filter(n=>n.participant_id===t),s=l.filter(n=>n.score===3).length,r=l.filter(n=>n.score===2).length,i=l.filter(n=>n.score===1).length;return{gold:s,silver:r,bronze:i,total:s+r+i}},m=()=>[...a.participants].sort((t,l)=>{const s=o(t.id),r=o(l.id);return r.gold!==s.gold?r.gold-s.gold:r.silver!==s.silver?r.silver-s.silver:r.bronze!==s.bronze?r.bronze-s.bronze:0}),b=(t,l)=>{const s=a.scores.filter(r=>r.event_id===t&&r.participant_id===l);return s.length===0?"-":s.map((r,i)=>{switch(parseInt(r.score)){case 3:return e.jsx("span",{className:"inline-block mx-0.5",children:"ðŸ¥‡"},i);case 2:return e.jsx("span",{className:"inline-block mx-0.5",children:"ðŸ¥ˆ"},i);case 1:return e.jsx("span",{className:"inline-block mx-0.5",children:"ðŸ¥‰"},i);default:return null}})},p=t=>{const l=t.toUpperCase();return l.includes("CBE")?"border-l-4 border-yellow-500 bg-yellow-50":l.includes("CTE")?"border-l-4 border-blue-600 bg-blue-50":l.includes("CCJE")?"border-l-4 border-red-500 bg-red-50":"border-l-4 border-gray-300"};return e.jsxs(e.Fragment,{children:[e.jsx(h,{title:`${a.tally_title} - Medal Tally`}),e.jsx("style",{children:`
                @media print {
                    body { 
                        margin: 0;
                        padding: 20px;
                    }
                    @page {
                        size: A4 landscape;
                        margin: 15mm;
                    }
                    .no-print {
                        display: none;
                    }
                    .page-break {
                        page-break-before: always;
                    }
                }
                
                body {
                    font-family: Arial, sans-serif;
                }
            `}),e.jsxs("div",{className:"max-w-full mx-auto p-8 bg-white",children:[e.jsxs("div",{className:"mb-8 border-b-4 border-gray-800 pb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4 px-8",children:[e.jsx("img",{src:g,alt:"SFXC Logo",style:{width:"100px",height:"auto"}}),c&&e.jsx("img",{src:c,alt:"Event Logo",style:{width:"100px",height:"auto"}})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:a.tally_title}),e.jsx("p",{className:"text-xl text-gray-600",children:"Complete Medal Tally Report"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[a.events?.length," Competitions â€¢ ",a.participants?.length," Participants"]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Generated on ",new Date().toLocaleString()]})]})]}),e.jsxs("div",{className:"mb-10",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4 border-b-2 border-gray-300 pb-2",children:"Overall Medal Standings"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m().map((t,l)=>{const s=o(t.id),r=l+1;return e.jsxs("div",{className:`rounded-lg p-4 border ${p(t.participant_name)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-bold text-lg",children:t.participant_name}),s.total>0&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-bold bg-gray-800 text-white",children:["#",r]})]}),e.jsx("table",{className:"w-full text-sm",children:e.jsxs("tbody",{children:[e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-1",children:"ðŸ¥‡ Gold"}),e.jsx("td",{className:"py-1 text-right font-semibold",children:s.gold})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-1",children:"ðŸ¥ˆ Silver"}),e.jsx("td",{className:"py-1 text-right font-semibold",children:s.silver})]}),e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-1",children:"ðŸ¥‰ Bronze"}),e.jsx("td",{className:"py-1 text-right font-semibold",children:s.bronze})]}),e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{className:"py-1 pt-2",children:"Total Medals"}),e.jsx("td",{className:"py-1 pt-2 text-right",children:s.total})]})]})})]},t.id)})})]}),e.jsxs("div",{className:"page-break",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4 border-b-2 border-gray-300 pb-2",children:"Detailed Competition Results"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-800 text-white",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-3 text-left font-bold",children:"Competition"}),a.participants.map(t=>e.jsx("th",{className:"border border-gray-300 px-4 py-3 text-center font-bold",children:t.participant_name},t.id))]})}),e.jsx("tbody",{children:a.events.map((t,l)=>e.jsxs("tr",{className:l%2===0?"bg-gray-50":"bg-white",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-3 font-semibold",children:t.event_name}),a.participants.map(s=>e.jsx("td",{className:"border border-gray-300 px-4 py-3 text-center text-2xl",children:b(t.id,s.id)},s.id))]},t.id))})]})})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t border-gray-300 text-center text-sm text-gray-500",children:[e.jsx("p",{children:"SFXC Tabulation System - Medal Tally Report"}),e.jsx("p",{children:"Rankings are based on Gold medals first, then Silver, then Bronze"})]}),e.jsxs("div",{className:"no-print mt-6 text-center",children:[e.jsx("button",{onClick:()=>window.print(),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold",children:"Print This Report"}),e.jsx("button",{onClick:()=>window.close(),className:"ml-4 px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 font-semibold",children:"Close"})]})]})]})}export{f as default};
